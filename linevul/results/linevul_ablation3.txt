slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
Matplotlib created a temporary cache directory at /scratch/39451/matplotlib-1bcp892n because the default path (/home/schroeder_e/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
11/22/2023 11:02:10 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
11/22/2023 11:02:14 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/big-vul_dataset/val.csv', test_data_file='../data/big-vul_dataset/test.csv', model_name='WordlevelPretrainedBERT.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=256, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
  0%|          | 0/18864 [00:00<?, ?it/s]  0%|          | 67/18864 [00:00<00:29, 639.63it/s]  1%|          | 135/18864 [00:00<00:28, 659.80it/s]  1%|          | 202/18864 [00:00<00:30, 610.30it/s]  1%|▏         | 264/18864 [00:00<00:31, 591.60it/s]  2%|▏         | 334/18864 [00:00<00:30, 610.28it/s]  2%|▏         | 399/18864 [00:00<00:30, 610.26it/s]  2%|▏         | 461/18864 [00:00<00:31, 579.48it/s]  3%|▎         | 541/18864 [00:00<00:28, 644.02it/s]  3%|▎         | 607/18864 [00:00<00:29, 628.15it/s]  4%|▎         | 671/18864 [00:01<00:29, 625.97it/s]  4%|▍         | 751/18864 [00:01<00:26, 676.09it/s]  4%|▍         | 820/18864 [00:01<00:30, 587.83it/s]  5%|▍         | 884/18864 [00:01<00:29, 600.88it/s]  5%|▌         | 946/18864 [00:01<00:33, 529.58it/s]  5%|▌         | 1028/18864 [00:01<00:29, 603.02it/s]  6%|▌         | 1112/18864 [00:01<00:26, 664.96it/s]  6%|▋         | 1187/18864 [00:01<00:25, 687.28it/s]  7%|▋         | 1258/18864 [00:02<00:26, 666.61it/s]  7%|▋         | 1337/18864 [00:02<00:25, 690.98it/s]  7%|▋         | 1408/18864 [00:02<00:25, 678.08it/s]  8%|▊         | 1477/18864 [00:02<00:26, 663.56it/s]  8%|▊         | 1564/18864 [00:02<00:25, 687.27it/s]  9%|▊         | 1639/18864 [00:02<00:24, 703.52it/s]  9%|▉         | 1717/18864 [00:02<00:23, 723.89it/s] 10%|▉         | 1804/18864 [00:02<00:22, 765.76it/s] 10%|▉         | 1884/18864 [00:02<00:21, 773.51it/s] 10%|█         | 1962/18864 [00:02<00:22, 767.54it/s] 11%|█         | 2048/18864 [00:03<00:21, 794.12it/s] 11%|█▏        | 2128/18864 [00:03<00:21, 769.21it/s] 12%|█▏        | 2209/18864 [00:03<00:21, 779.59it/s] 12%|█▏        | 2288/18864 [00:03<00:22, 725.83it/s] 13%|█▎        | 2363/18864 [00:03<00:22, 731.99it/s] 13%|█▎        | 2437/18864 [00:03<00:22, 729.57it/s] 13%|█▎        | 2511/18864 [00:03<00:23, 691.67it/s] 14%|█▎        | 2581/18864 [00:03<00:25, 627.31it/s] 14%|█▍        | 2646/18864 [00:03<00:27, 581.36it/s] 14%|█▍        | 2723/18864 [00:04<00:25, 629.65it/s] 15%|█▍        | 2810/18864 [00:04<00:23, 691.26it/s] 15%|█▌        | 2881/18864 [00:04<00:24, 658.90it/s] 16%|█▌        | 2952/18864 [00:04<00:23, 669.99it/s] 16%|█▌        | 3030/18864 [00:04<00:22, 700.58it/s] 16%|█▋        | 3102/18864 [00:04<00:23, 679.71it/s] 17%|█▋        | 3171/18864 [00:04<00:23, 676.75it/s] 17%|█▋        | 3240/18864 [00:04<00:23, 672.51it/s] 18%|█▊        | 3328/18864 [00:04<00:21, 726.98it/s] 18%|█▊        | 3402/18864 [00:05<00:23, 669.97it/s] 18%|█▊        | 3485/18864 [00:05<00:21, 711.46it/s] 19%|█▉        | 3558/18864 [00:05<00:21, 700.23it/s] 19%|█▉        | 3629/18864 [00:05<00:24, 612.37it/s] 20%|█▉        | 3693/18864 [00:05<00:24, 612.24it/s] 20%|█▉        | 3768/18864 [00:05<00:23, 648.69it/s] 20%|██        | 3836/18864 [00:05<00:22, 654.60it/s] 21%|██        | 3924/18864 [00:05<00:20, 716.53it/s] 21%|██▏       | 4012/18864 [00:05<00:19, 763.25it/s] 22%|██▏       | 4090/18864 [00:06<00:19, 753.10it/s] 22%|██▏       | 4167/18864 [00:06<00:20, 728.54it/s] 22%|██▏       | 4241/18864 [00:06<00:21, 693.98it/s] 23%|██▎       | 4312/18864 [00:06<00:21, 690.92it/s] 23%|██▎       | 4382/18864 [00:06<00:24, 583.23it/s] 24%|██▍       | 4484/18864 [00:06<00:20, 692.15it/s] 24%|██▍       | 4573/18864 [00:06<00:19, 741.30it/s] 25%|██▍       | 4651/18864 [00:06<00:21, 666.82it/s] 25%|██▌       | 4722/18864 [00:07<00:21, 664.07it/s] 25%|██▌       | 4791/18864 [00:07<00:21, 658.56it/s] 26%|██▌       | 4874/18864 [00:07<00:20, 699.22it/s] 26%|██▋       | 4952/18864 [00:07<00:19, 715.91it/s] 27%|██▋       | 5050/18864 [00:07<00:17, 788.97it/s] 27%|██▋       | 5131/18864 [00:07<00:18, 754.94it/s] 28%|██▊       | 5208/18864 [00:07<00:19, 687.95it/s] 28%|██▊       | 5296/18864 [00:07<00:19, 707.20it/s] 28%|██▊       | 5370/18864 [00:07<00:18, 714.55it/s] 29%|██▉       | 5443/18864 [00:07<00:18, 713.49it/s] 29%|██▉       | 5520/18864 [00:08<00:18, 729.21it/s] 30%|██▉       | 5603/18864 [00:08<00:17, 756.80it/s] 30%|███       | 5680/18864 [00:08<00:19, 688.84it/s] 31%|███       | 5778/18864 [00:08<00:17, 760.36it/s] 31%|███       | 5856/18864 [00:08<00:17, 731.15it/s] 31%|███▏      | 5931/18864 [00:08<00:17, 724.90it/s] 32%|███▏      | 6005/18864 [00:08<00:18, 704.82it/s] 32%|███▏      | 6077/18864 [00:08<00:18, 692.07it/s] 33%|███▎      | 6151/18864 [00:08<00:18, 704.63it/s] 33%|███▎      | 6235/18864 [00:09<00:17, 732.55it/s] 33%|███▎      | 6309/18864 [00:09<00:17, 724.15it/s] 34%|███▍      | 6384/18864 [00:09<00:17, 727.83it/s] 34%|███▍      | 6473/18864 [00:09<00:16, 774.01it/s] 35%|███▍      | 6557/18864 [00:09<00:15, 788.69it/s] 35%|███▌      | 6637/18864 [00:09<00:15, 790.55it/s] 36%|███▌      | 6717/18864 [00:09<00:16, 743.49it/s] 36%|███▌      | 6796/18864 [00:09<00:15, 756.16it/s] 36%|███▋      | 6873/18864 [00:09<00:18, 646.55it/s] 37%|███▋      | 6948/18864 [00:10<00:17, 671.94it/s] 37%|███▋      | 7023/18864 [00:10<00:17, 691.90it/s] 38%|███▊      | 7100/18864 [00:10<00:16, 712.88it/s] 38%|███▊      | 7173/18864 [00:10<00:16, 710.23it/s] 38%|███▊      | 7246/18864 [00:10<00:18, 618.28it/s] 39%|███▉      | 7319/18864 [00:10<00:17, 644.81it/s] 39%|███▉      | 7395/18864 [00:10<00:17, 669.19it/s] 40%|███▉      | 7481/18864 [00:10<00:16, 692.59it/s] 40%|████      | 7559/18864 [00:10<00:15, 713.82it/s] 41%|████      | 7649/18864 [00:11<00:14, 766.13it/s] 41%|████      | 7727/18864 [00:11<00:16, 691.92it/s] 41%|████▏     | 7821/18864 [00:11<00:14, 752.38it/s] 42%|████▏     | 7899/18864 [00:11<00:16, 669.95it/s] 42%|████▏     | 7979/18864 [00:11<00:15, 699.53it/s] 43%|████▎     | 8052/18864 [00:11<00:16, 671.47it/s] 43%|████▎     | 8140/18864 [00:11<00:14, 725.90it/s] 44%|████▎     | 8220/18864 [00:11<00:14, 743.02it/s] 44%|████▍     | 8303/18864 [00:11<00:13, 763.41it/s] 44%|████▍     | 8382/18864 [00:12<00:13, 769.53it/s] 45%|████▍     | 8486/18864 [00:12<00:12, 837.65it/s] 45%|████▌     | 8571/18864 [00:12<00:13, 774.08it/s] 46%|████▌     | 8655/18864 [00:12<00:12, 791.10it/s] 46%|████▋     | 8736/18864 [00:12<00:13, 765.60it/s] 47%|████▋     | 8829/18864 [00:12<00:12, 810.61it/s] 47%|████▋     | 8911/18864 [00:12<00:12, 776.41it/s] 48%|████▊     | 8990/18864 [00:12<00:13, 740.04it/s] 48%|████▊     | 9070/18864 [00:12<00:13, 745.37it/s] 48%|████▊     | 9148/18864 [00:13<00:12, 754.71it/s] 49%|████▉     | 9224/18864 [00:13<00:14, 678.22it/s] 49%|████▉     | 9307/18864 [00:13<00:13, 715.54it/s] 50%|████▉     | 9393/18864 [00:13<00:12, 742.97it/s] 50%|█████     | 9469/18864 [00:13<00:13, 716.73it/s] 51%|█████     | 9553/18864 [00:13<00:12, 749.57it/s] 51%|█████     | 9629/18864 [00:13<00:12, 746.87it/s] 52%|█████▏    | 9730/18864 [00:14<00:19, 474.05it/s] 52%|█████▏    | 9829/18864 [00:14<00:15, 571.95it/s] 53%|█████▎    | 9921/18864 [00:14<00:13, 644.97it/s] 53%|█████▎    | 9999/18864 [00:14<00:14, 612.54it/s] 53%|█████▎    | 10076/18864 [00:14<00:13, 648.68it/s] 54%|█████▍    | 10149/18864 [00:14<00:13, 648.24it/s] 54%|█████▍    | 10251/18864 [00:14<00:11, 742.69it/s] 55%|█████▍    | 10331/18864 [00:14<00:12, 685.33it/s] 55%|█████▌    | 10404/18864 [00:15<00:12, 677.52it/s] 56%|█████▌    | 10494/18864 [00:15<00:11, 734.66it/s] 56%|█████▌    | 10571/18864 [00:15<00:11, 719.68it/s] 56%|█████▋    | 10645/18864 [00:15<00:11, 711.44it/s] 57%|█████▋    | 10736/18864 [00:15<00:10, 766.21it/s] 57%|█████▋    | 10818/18864 [00:15<00:10, 781.30it/s] 58%|█████▊    | 10898/18864 [00:15<00:12, 645.58it/s] 58%|█████▊    | 10968/18864 [00:15<00:12, 651.04it/s] 59%|█████▊    | 11050/18864 [00:15<00:11, 690.91it/s] 59%|█████▉    | 11131/18864 [00:16<00:10, 713.05it/s] 59%|█████▉    | 11223/18864 [00:16<00:09, 769.83it/s] 60%|█████▉    | 11302/18864 [00:16<00:09, 763.00it/s] 60%|██████    | 11389/18864 [00:16<00:09, 792.84it/s] 61%|██████    | 11486/18864 [00:16<00:08, 837.93it/s] 61%|██████▏   | 11571/18864 [00:16<00:13, 534.97it/s] 62%|██████▏   | 11654/18864 [00:16<00:12, 595.46it/s] 62%|██████▏   | 11727/18864 [00:16<00:11, 625.16it/s] 63%|██████▎   | 11800/18864 [00:17<00:11, 638.14it/s] 63%|██████▎   | 11891/18864 [00:17<00:09, 707.81it/s] 63%|██████▎   | 11968/18864 [00:17<00:10, 670.98it/s] 64%|██████▍   | 12050/18864 [00:17<00:09, 699.27it/s] 64%|██████▍   | 12128/18864 [00:17<00:09, 718.55it/s] 65%|██████▍   | 12214/18864 [00:17<00:08, 756.48it/s] 65%|██████▌   | 12292/18864 [00:17<00:08, 760.86it/s] 66%|██████▌   | 12371/18864 [00:17<00:08, 768.53it/s] 66%|██████▌   | 12449/18864 [00:17<00:08, 749.92it/s] 66%|██████▋   | 12525/18864 [00:17<00:08, 738.69it/s] 67%|██████▋   | 12600/18864 [00:18<00:08, 738.65it/s] 67%|██████▋   | 12699/18864 [00:18<00:07, 810.25it/s] 68%|██████▊   | 12781/18864 [00:18<00:07, 769.46it/s] 68%|██████▊   | 12859/18864 [00:18<00:07, 757.83it/s] 69%|██████▊   | 12945/18864 [00:18<00:07, 785.07it/s] 69%|██████▉   | 13024/18864 [00:18<00:07, 767.28it/s] 70%|██████▉   | 13119/18864 [00:18<00:07, 819.55it/s] 70%|███████   | 13208/18864 [00:18<00:07, 789.07it/s] 70%|███████   | 13296/18864 [00:18<00:06, 814.22it/s] 71%|███████   | 13379/18864 [00:19<00:06, 788.89it/s] 71%|███████▏  | 13463/18864 [00:19<00:06, 797.38it/s] 72%|███████▏  | 13544/18864 [00:19<00:06, 769.45it/s] 72%|███████▏  | 13622/18864 [00:19<00:06, 771.29it/s] 73%|███████▎  | 13700/18864 [00:19<00:06, 771.98it/s] 73%|███████▎  | 13778/18864 [00:19<00:06, 763.01it/s] 74%|███████▎  | 13871/18864 [00:19<00:06, 800.94it/s] 74%|███████▍  | 13952/18864 [00:19<00:06, 761.90it/s] 74%|███████▍  | 14039/18864 [00:19<00:06, 778.29it/s] 75%|███████▍  | 14129/18864 [00:20<00:05, 806.11it/s] 75%|███████▌  | 14210/18864 [00:20<00:05, 803.20it/s] 76%|███████▌  | 14291/18864 [00:20<00:05, 775.88it/s] 76%|███████▌  | 14375/18864 [00:20<00:05, 791.55it/s] 77%|███████▋  | 14458/18864 [00:20<00:05, 801.36it/s] 77%|███████▋  | 14539/18864 [00:20<00:05, 790.98it/s] 77%|███████▋  | 14619/18864 [00:20<00:05, 730.38it/s] 78%|███████▊  | 14700/18864 [00:20<00:05, 751.46it/s] 78%|███████▊  | 14788/18864 [00:20<00:05, 787.29it/s] 79%|███████▉  | 14885/18864 [00:20<00:04, 835.43it/s] 79%|███████▉  | 14985/18864 [00:21<00:04, 879.34it/s] 80%|███████▉  | 15074/18864 [00:21<00:04, 815.73it/s] 80%|████████  | 15168/18864 [00:21<00:04, 846.16it/s] 81%|████████  | 15268/18864 [00:21<00:04, 889.19it/s] 81%|████████▏ | 15358/18864 [00:21<00:04, 844.13it/s] 82%|████████▏ | 15444/18864 [00:21<00:04, 833.66it/s] 82%|████████▏ | 15529/18864 [00:21<00:04, 753.99it/s] 83%|████████▎ | 15628/18864 [00:21<00:03, 813.99it/s] 83%|████████▎ | 15712/18864 [00:21<00:03, 820.50it/s] 84%|████████▍ | 15807/18864 [00:22<00:03, 856.48it/s] 84%|████████▍ | 15911/18864 [00:22<00:03, 907.07it/s] 85%|████████▍ | 16003/18864 [00:22<00:03, 855.46it/s] 85%|████████▌ | 16090/18864 [00:22<00:03, 858.02it/s] 86%|████████▌ | 16177/18864 [00:22<00:04, 662.38it/s] 86%|████████▌ | 16260/18864 [00:22<00:03, 699.85it/s] 87%|████████▋ | 16357/18864 [00:22<00:03, 763.81it/s] 87%|████████▋ | 16440/18864 [00:22<00:03, 777.70it/s] 88%|████████▊ | 16523/18864 [00:23<00:02, 791.67it/s] 88%|████████▊ | 16611/18864 [00:23<00:02, 815.58it/s] 89%|████████▊ | 16717/18864 [00:23<00:02, 882.74it/s] 89%|████████▉ | 16808/18864 [00:23<00:02, 867.55it/s] 90%|████████▉ | 16897/18864 [00:23<00:02, 846.46it/s] 90%|█████████ | 16983/18864 [00:23<00:02, 843.01it/s] 91%|█████████ | 17085/18864 [00:23<00:01, 893.35it/s] 91%|█████████ | 17176/18864 [00:23<00:01, 852.94it/s] 92%|█████████▏| 17277/18864 [00:23<00:01, 895.56it/s] 92%|█████████▏| 17371/18864 [00:23<00:01, 906.84it/s] 93%|█████████▎| 17463/18864 [00:24<00:01, 878.60it/s] 93%|█████████▎| 17552/18864 [00:24<00:01, 803.84it/s] 93%|█████████▎| 17634/18864 [00:24<00:01, 765.25it/s] 94%|█████████▍| 17712/18864 [00:24<00:01, 733.35it/s] 94%|█████████▍| 17789/18864 [00:24<00:01, 741.88it/s] 95%|█████████▍| 17871/18864 [00:24<00:01, 762.93it/s] 95%|█████████▌| 17956/18864 [00:24<00:01, 785.16it/s] 96%|█████████▌| 18036/18864 [00:24<00:01, 773.21it/s] 96%|█████████▌| 18114/18864 [00:24<00:00, 762.59it/s] 96%|█████████▋| 18191/18864 [00:25<00:00, 719.80it/s] 97%|█████████▋| 18268/18864 [00:25<00:00, 729.85it/s] 97%|█████████▋| 18369/18864 [00:25<00:00, 808.81it/s] 98%|█████████▊| 18451/18864 [00:25<00:00, 777.06it/s] 98%|█████████▊| 18530/18864 [00:25<00:00, 717.78it/s] 99%|█████████▊| 18605/18864 [00:25<00:00, 724.90it/s] 99%|█████████▉| 18679/18864 [00:25<00:00, 701.02it/s] 99%|█████████▉| 18768/18864 [00:25<00:00, 725.44it/s]100%|█████████▉| 18842/18864 [00:25<00:00, 709.91it/s]100%|██████████| 18864/18864 [00:25<00:00, 725.84it/s]
11/22/2023 11:02:54 - INFO - __main__ -   ***** Running Test *****
11/22/2023 11:02:54 - INFO - __main__ -     Num examples = 18864
11/22/2023 11:02:54 - INFO - __main__ -     Batch size = 256
11/22/2023 11:08:20 - INFO - __main__ -   ***** Test results *****
11/22/2023 11:08:20 - INFO - __main__ -     test_accuracy = 0.9002
11/22/2023 11:08:20 - INFO - __main__ -     test_f1 = 0.0646
11/22/2023 11:08:20 - INFO - __main__ -     test_precision = 0.0678
11/22/2023 11:08:20 - INFO - __main__ -     test_recall = 0.0616
11/22/2023 11:08:20 - INFO - __main__ -     test_threshold = 0.5
