slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
Matplotlib created a temporary cache directory at /scratch/39439/matplotlib-kn7c1y5p because the default path (/home/schroeder_e/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
11/22/2023 10:36:30 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.out_proj.bias', 'classifier.dense.weight', 'classifier.dense.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
11/22/2023 10:36:35 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/big-vul_dataset/val.csv', test_data_file='../data/big-vul_dataset/test.csv', model_name='12heads_linevul_model.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=256, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
  0%|          | 0/18864 [00:00<?, ?it/s]  0%|          | 62/18864 [00:00<00:30, 611.56it/s]  1%|          | 124/18864 [00:00<00:31, 601.84it/s]  1%|          | 185/18864 [00:00<00:31, 598.37it/s]  1%|▏         | 245/18864 [00:00<00:32, 568.93it/s]  2%|▏         | 308/18864 [00:00<00:31, 587.97it/s]  2%|▏         | 369/18864 [00:00<00:31, 594.44it/s]  2%|▏         | 430/18864 [00:00<00:30, 598.37it/s]  3%|▎         | 501/18864 [00:00<00:29, 632.73it/s]  3%|▎         | 565/18864 [00:00<00:31, 588.56it/s]  3%|▎         | 646/18864 [00:01<00:28, 650.60it/s]  4%|▍         | 715/18864 [00:01<00:27, 660.31it/s]  4%|▍         | 790/18864 [00:01<00:26, 686.48it/s]  5%|▍         | 860/18864 [00:01<00:31, 574.86it/s]  5%|▍         | 924/18864 [00:01<00:31, 572.07it/s]  5%|▌         | 984/18864 [00:01<00:32, 546.46it/s]  6%|▌         | 1072/18864 [00:01<00:28, 633.81it/s]  6%|▌         | 1138/18864 [00:01<00:28, 625.76it/s]  6%|▋         | 1206/18864 [00:01<00:27, 638.90it/s]  7%|▋         | 1292/18864 [00:02<00:25, 698.92it/s]  7%|▋         | 1365/18864 [00:02<00:25, 697.22it/s]  8%|▊         | 1436/18864 [00:02<00:25, 688.95it/s]  8%|▊         | 1506/18864 [00:02<00:25, 686.17it/s]  8%|▊         | 1576/18864 [00:02<00:25, 688.16it/s]  9%|▉         | 1656/18864 [00:02<00:23, 717.35it/s]  9%|▉         | 1728/18864 [00:02<00:23, 714.04it/s] 10%|▉         | 1825/18864 [00:02<00:21, 786.70it/s] 10%|█         | 1904/18864 [00:02<00:22, 761.61it/s] 11%|█         | 1988/18864 [00:03<00:21, 780.89it/s] 11%|█         | 2067/18864 [00:03<00:21, 766.44it/s] 11%|█▏        | 2156/18864 [00:03<00:20, 800.05it/s] 12%|█▏        | 2237/18864 [00:03<00:21, 788.05it/s] 12%|█▏        | 2316/18864 [00:03<00:23, 718.30it/s] 13%|█▎        | 2390/18864 [00:03<00:22, 720.40it/s] 13%|█▎        | 2463/18864 [00:03<00:23, 705.42it/s] 13%|█▎        | 2535/18864 [00:03<00:26, 624.30it/s] 14%|█▍        | 2600/18864 [00:03<00:27, 590.82it/s] 14%|█▍        | 2661/18864 [00:04<00:28, 578.33it/s] 15%|█▍        | 2752/18864 [00:04<00:24, 657.67it/s] 15%|█▌        | 2835/18864 [00:04<00:25, 639.93it/s] 15%|█▌        | 2909/18864 [00:04<00:23, 665.28it/s] 16%|█▌        | 2987/18864 [00:04<00:22, 695.86it/s] 16%|█▌        | 3059/18864 [00:04<00:22, 700.16it/s] 17%|█▋        | 3130/18864 [00:04<00:23, 674.66it/s] 17%|█▋        | 3199/18864 [00:04<00:25, 618.04it/s] 17%|█▋        | 3273/18864 [00:04<00:23, 650.51it/s] 18%|█▊        | 3362/18864 [00:05<00:21, 716.53it/s] 18%|█▊        | 3436/18864 [00:05<00:22, 697.85it/s] 19%|█▊        | 3512/18864 [00:05<00:21, 713.89it/s] 19%|█▉        | 3585/18864 [00:05<00:23, 649.25it/s] 19%|█▉        | 3652/18864 [00:05<00:23, 650.42it/s] 20%|█▉        | 3719/18864 [00:05<00:23, 647.93it/s] 20%|██        | 3788/18864 [00:05<00:22, 656.29it/s] 20%|██        | 3855/18864 [00:05<00:22, 656.41it/s] 21%|██        | 3947/18864 [00:05<00:20, 726.22it/s] 21%|██▏       | 4026/18864 [00:06<00:20, 724.34it/s] 22%|██▏       | 4107/18864 [00:06<00:19, 743.67it/s] 22%|██▏       | 4182/18864 [00:06<00:20, 729.88it/s] 23%|██▎       | 4256/18864 [00:06<00:21, 683.61it/s] 23%|██▎       | 4325/18864 [00:06<00:21, 677.85it/s] 23%|██▎       | 4394/18864 [00:06<00:25, 578.06it/s] 24%|██▍       | 4500/18864 [00:06<00:20, 700.14it/s] 24%|██▍       | 4587/18864 [00:06<00:19, 744.39it/s] 25%|██▍       | 4665/18864 [00:06<00:22, 622.54it/s] 25%|██▌       | 4741/18864 [00:07<00:21, 655.72it/s] 26%|██▌       | 4812/18864 [00:07<00:21, 651.29it/s] 26%|██▌       | 4886/18864 [00:07<00:20, 672.14it/s] 26%|██▋       | 4970/18864 [00:07<00:19, 717.10it/s] 27%|██▋       | 5061/18864 [00:07<00:17, 770.65it/s] 27%|██▋       | 5140/18864 [00:07<00:18, 725.52it/s] 28%|██▊       | 5215/18864 [00:07<00:20, 672.59it/s] 28%|██▊       | 5285/18864 [00:07<00:20, 676.15it/s] 28%|██▊       | 5354/18864 [00:07<00:20, 659.78it/s] 29%|██▉       | 5433/18864 [00:08<00:19, 695.08it/s] 29%|██▉       | 5504/18864 [00:08<00:19, 689.93it/s] 30%|██▉       | 5586/18864 [00:08<00:18, 719.67it/s] 30%|███       | 5667/18864 [00:08<00:18, 720.16it/s] 30%|███       | 5740/18864 [00:08<00:18, 711.45it/s] 31%|███       | 5822/18864 [00:08<00:17, 741.82it/s] 31%|███▏      | 5897/18864 [00:08<00:18, 701.80it/s] 32%|███▏      | 5968/18864 [00:08<00:19, 664.95it/s] 32%|███▏      | 6043/18864 [00:08<00:19, 670.80it/s] 32%|███▏      | 6123/18864 [00:09<00:18, 693.52it/s] 33%|███▎      | 6195/18864 [00:09<00:18, 695.38it/s] 33%|███▎      | 6270/18864 [00:09<00:17, 705.52it/s] 34%|███▎      | 6347/18864 [00:09<00:17, 717.81it/s] 34%|███▍      | 6433/18864 [00:09<00:16, 758.73it/s] 35%|███▍      | 6516/18864 [00:09<00:15, 776.84it/s] 35%|███▍      | 6594/18864 [00:09<00:15, 775.13it/s] 35%|███▌      | 6672/18864 [00:09<00:16, 722.18it/s] 36%|███▌      | 6752/18864 [00:09<00:16, 733.09it/s] 36%|███▌      | 6826/18864 [00:10<00:16, 721.23it/s] 37%|███▋      | 6899/18864 [00:10<00:18, 641.29it/s] 37%|███▋      | 6979/18864 [00:10<00:17, 681.06it/s] 37%|███▋      | 7056/18864 [00:10<00:16, 703.86it/s] 38%|███▊      | 7130/18864 [00:10<00:16, 713.71it/s] 38%|███▊      | 7203/18864 [00:10<00:19, 603.58it/s] 39%|███▊      | 7284/18864 [00:10<00:17, 654.60it/s] 39%|███▉      | 7353/18864 [00:10<00:17, 647.71it/s] 39%|███▉      | 7421/18864 [00:10<00:17, 647.58it/s] 40%|███▉      | 7502/18864 [00:11<00:16, 692.43it/s] 40%|████      | 7580/18864 [00:11<00:15, 711.70it/s] 41%|████      | 7668/18864 [00:11<00:14, 759.44it/s] 41%|████      | 7745/18864 [00:11<00:15, 700.67it/s] 42%|████▏     | 7836/18864 [00:11<00:14, 756.61it/s] 42%|████▏     | 7914/18864 [00:11<00:16, 659.53it/s] 42%|████▏     | 7995/18864 [00:11<00:15, 698.20it/s] 43%|████▎     | 8068/18864 [00:11<00:16, 664.67it/s] 43%|████▎     | 8153/18864 [00:11<00:15, 672.89it/s] 44%|████▎     | 8249/18864 [00:12<00:14, 748.21it/s] 44%|████▍     | 8326/18864 [00:12<00:14, 730.46it/s] 45%|████▍     | 8419/18864 [00:12<00:13, 783.39it/s] 45%|████▌     | 8512/18864 [00:12<00:13, 793.98it/s] 46%|████▌     | 8593/18864 [00:12<00:13, 785.21it/s] 46%|████▌     | 8673/18864 [00:12<00:13, 769.39it/s] 46%|████▋     | 8751/18864 [00:12<00:13, 766.33it/s] 47%|████▋     | 8839/18864 [00:12<00:12, 794.39it/s] 47%|████▋     | 8919/18864 [00:12<00:12, 765.91it/s] 48%|████▊     | 8996/18864 [00:13<00:13, 715.45it/s] 48%|████▊     | 9073/18864 [00:13<00:13, 728.78it/s] 49%|████▊     | 9151/18864 [00:13<00:13, 737.69it/s] 49%|████▉     | 9226/18864 [00:13<00:14, 665.34it/s] 49%|████▉     | 9308/18864 [00:13<00:13, 705.42it/s] 50%|████▉     | 9384/18864 [00:13<00:13, 702.18it/s] 50%|█████     | 9458/18864 [00:13<00:13, 712.10it/s] 51%|█████     | 9531/18864 [00:13<00:13, 709.31it/s] 51%|█████     | 9603/18864 [00:14<00:21, 425.82it/s] 51%|█████▏    | 9689/18864 [00:14<00:18, 509.66it/s] 52%|█████▏    | 9801/18864 [00:14<00:14, 642.64it/s] 52%|█████▏    | 9893/18864 [00:14<00:12, 707.01it/s] 53%|█████▎    | 9976/18864 [00:14<00:12, 711.72it/s] 53%|█████▎    | 10056/18864 [00:14<00:13, 655.75it/s] 54%|█████▎    | 10133/18864 [00:14<00:12, 683.18it/s] 54%|█████▍    | 10217/18864 [00:14<00:11, 723.98it/s] 55%|█████▍    | 10294/18864 [00:15<00:11, 724.54it/s] 55%|█████▍    | 10370/18864 [00:15<00:12, 654.96it/s] 55%|█████▌    | 10464/18864 [00:15<00:11, 723.25it/s] 56%|█████▌    | 10540/18864 [00:15<00:11, 730.71it/s] 56%|█████▋    | 10616/18864 [00:15<00:11, 718.45it/s] 57%|█████▋    | 10690/18864 [00:15<00:11, 723.43it/s] 57%|█████▋    | 10789/18864 [00:15<00:10, 797.75it/s] 58%|█████▊    | 10870/18864 [00:15<00:12, 655.06it/s] 58%|█████▊    | 10941/18864 [00:15<00:12, 645.32it/s] 58%|█████▊    | 11025/18864 [00:16<00:11, 691.75it/s] 59%|█████▉    | 11107/18864 [00:16<00:10, 723.05it/s] 59%|█████▉    | 11191/18864 [00:16<00:10, 738.78it/s] 60%|█████▉    | 11276/18864 [00:16<00:09, 769.50it/s] 60%|██████    | 11355/18864 [00:16<00:09, 765.41it/s] 61%|██████    | 11449/18864 [00:16<00:09, 811.71it/s] 61%|██████    | 11532/18864 [00:16<00:13, 532.53it/s] 61%|██████▏   | 11599/18864 [00:16<00:13, 557.05it/s] 62%|██████▏   | 11686/18864 [00:17<00:11, 599.38it/s] 62%|██████▏   | 11774/18864 [00:17<00:10, 663.62it/s] 63%|██████▎   | 11859/18864 [00:17<00:09, 707.83it/s] 63%|██████▎   | 11936/18864 [00:17<00:10, 668.52it/s] 64%|██████▎   | 12024/18864 [00:17<00:09, 722.95it/s] 64%|██████▍   | 12101/18864 [00:17<00:09, 717.99it/s] 65%|██████▍   | 12181/18864 [00:17<00:09, 740.36it/s] 65%|██████▌   | 12264/18864 [00:17<00:08, 765.39it/s] 65%|██████▌   | 12343/18864 [00:17<00:08, 746.25it/s] 66%|██████▌   | 12426/18864 [00:18<00:08, 767.93it/s] 66%|██████▋   | 12504/18864 [00:18<00:08, 727.10it/s] 67%|██████▋   | 12581/18864 [00:18<00:08, 738.75it/s] 67%|██████▋   | 12667/18864 [00:18<00:08, 773.26it/s] 68%|██████▊   | 12746/18864 [00:18<00:08, 724.09it/s] 68%|██████▊   | 12849/18864 [00:18<00:07, 808.43it/s] 69%|██████▊   | 12932/18864 [00:18<00:07, 756.81it/s] 69%|██████▉   | 13017/18864 [00:18<00:07, 781.85it/s] 69%|██████▉   | 13097/18864 [00:18<00:07, 781.56it/s] 70%|██████▉   | 13184/18864 [00:19<00:07, 805.58it/s] 70%|███████   | 13266/18864 [00:19<00:07, 779.91it/s] 71%|███████   | 13349/18864 [00:19<00:07, 787.08it/s] 71%|███████   | 13429/18864 [00:19<00:06, 788.99it/s] 72%|███████▏  | 13509/18864 [00:19<00:07, 744.29it/s] 72%|███████▏  | 13598/18864 [00:19<00:06, 784.64it/s] 73%|███████▎  | 13678/18864 [00:19<00:07, 719.05it/s] 73%|███████▎  | 13752/18864 [00:19<00:07, 721.16it/s] 73%|███████▎  | 13847/18864 [00:19<00:06, 784.18it/s] 74%|███████▍  | 13927/18864 [00:20<00:06, 758.96it/s] 74%|███████▍  | 14005/18864 [00:20<00:06, 763.45it/s] 75%|███████▍  | 14099/18864 [00:20<00:05, 802.09it/s] 75%|███████▌  | 14180/18864 [00:20<00:05, 788.76it/s] 76%|███████▌  | 14260/18864 [00:20<00:06, 767.10it/s] 76%|███████▌  | 14338/18864 [00:20<00:05, 770.11it/s] 76%|███████▋  | 14425/18864 [00:20<00:05, 797.41it/s] 77%|███████▋  | 14519/18864 [00:20<00:05, 834.23it/s] 77%|███████▋  | 14603/18864 [00:20<00:05, 768.30it/s] 78%|███████▊  | 14681/18864 [00:21<00:05, 733.64it/s] 78%|███████▊  | 14766/18864 [00:21<00:05, 763.73it/s] 79%|███████▉  | 14872/18864 [00:21<00:04, 846.02it/s] 79%|███████▉  | 14958/18864 [00:21<00:04, 836.32it/s] 80%|███████▉  | 15043/18864 [00:21<00:04, 829.52it/s] 80%|████████  | 15127/18864 [00:21<00:04, 817.98it/s] 81%|████████  | 15229/18864 [00:21<00:04, 873.94it/s] 81%|████████  | 15317/18864 [00:21<00:04, 867.76it/s] 82%|████████▏ | 15405/18864 [00:21<00:04, 834.88it/s] 82%|████████▏ | 15489/18864 [00:21<00:04, 771.75it/s] 83%|████████▎ | 15568/18864 [00:22<00:04, 769.69it/s] 83%|████████▎ | 15670/18864 [00:22<00:03, 839.41it/s] 84%|████████▎ | 15755/18864 [00:22<00:03, 807.24it/s] 84%|████████▍ | 15875/18864 [00:22<00:03, 913.67it/s] 85%|████████▍ | 15968/18864 [00:22<00:03, 885.29it/s] 85%|████████▌ | 16058/18864 [00:22<00:03, 864.89it/s] 86%|████████▌ | 16146/18864 [00:22<00:03, 806.94it/s] 86%|████████▌ | 16228/18864 [00:22<00:03, 668.58it/s] 86%|████████▋ | 16307/18864 [00:23<00:03, 694.59it/s] 87%|████████▋ | 16397/18864 [00:23<00:03, 745.21it/s] 87%|████████▋ | 16493/18864 [00:23<00:02, 798.96it/s] 88%|████████▊ | 16585/18864 [00:23<00:02, 818.52it/s] 88%|████████▊ | 16669/18864 [00:23<00:02, 753.83it/s] 89%|████████▉ | 16771/18864 [00:23<00:02, 797.55it/s] 89%|████████▉ | 16853/18864 [00:23<00:02, 797.49it/s] 90%|████████▉ | 16934/18864 [00:23<00:02, 738.23it/s] 90%|█████████ | 17031/18864 [00:23<00:02, 798.80it/s] 91%|█████████ | 17113/18864 [00:24<00:02, 799.52it/s] 91%|█████████ | 17196/18864 [00:24<00:02, 807.83it/s] 92%|█████████▏| 17299/18864 [00:24<00:01, 870.02it/s] 92%|█████████▏| 17389/18864 [00:24<00:01, 878.36it/s] 93%|█████████▎| 17478/18864 [00:24<00:01, 807.19it/s] 93%|█████████▎| 17561/18864 [00:24<00:01, 796.39it/s] 94%|█████████▎| 17642/18864 [00:24<00:01, 745.31it/s] 94%|█████████▍| 17718/18864 [00:24<00:01, 701.45it/s] 94%|█████████▍| 17805/18864 [00:24<00:01, 744.78it/s] 95%|█████████▍| 17881/18864 [00:25<00:01, 728.11it/s] 95%|█████████▌| 17965/18864 [00:25<00:01, 757.95it/s] 96%|█████████▌| 18043/18864 [00:25<00:01, 764.10it/s] 96%|█████████▌| 18122/18864 [00:25<00:00, 769.84it/s] 96%|█████████▋| 18200/18864 [00:25<00:00, 717.41it/s] 97%|█████████▋| 18284/18864 [00:25<00:00, 751.20it/s] 97%|█████████▋| 18378/18864 [00:25<00:00, 800.78it/s] 98%|█████████▊| 18459/18864 [00:25<00:00, 763.29it/s] 98%|█████████▊| 18537/18864 [00:25<00:00, 723.53it/s] 99%|█████████▊| 18611/18864 [00:25<00:00, 721.19it/s] 99%|█████████▉| 18684/18864 [00:26<00:00, 695.39it/s] 99%|█████████▉| 18768/18864 [00:26<00:00, 715.95it/s]100%|█████████▉| 18840/18864 [00:26<00:00, 698.24it/s]100%|██████████| 18864/18864 [00:26<00:00, 715.68it/s]
11/22/2023 10:37:23 - INFO - __main__ -   ***** Running Test *****
11/22/2023 10:37:23 - INFO - __main__ -     Num examples = 18864
11/22/2023 10:37:23 - INFO - __main__ -     Batch size = 256
11/22/2023 10:42:56 - INFO - __main__ -   ***** Test results *****
11/22/2023 10:42:56 - INFO - __main__ -     test_accuracy = 0.9909
11/22/2023 10:42:56 - INFO - __main__ -     test_f1 = 0.9142
11/22/2023 10:42:56 - INFO - __main__ -     test_precision = 0.9712
11/22/2023 10:42:56 - INFO - __main__ -     test_recall = 0.8635
11/22/2023 10:42:56 - INFO - __main__ -     test_threshold = 0.5
