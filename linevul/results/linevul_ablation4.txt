slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
Matplotlib created a temporary cache directory at /scratch/39461/matplotlib-ekc7vj_s because the default path (/home/schroeder_e/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
11/22/2023 11:20:35 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
11/22/2023 11:20:38 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/big-vul_dataset/val.csv', test_data_file='../data/big-vul_dataset/test.csv', model_name='WordlevelBERT.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=256, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
  0%|          | 0/18864 [00:00<?, ?it/s]  0%|          | 67/18864 [00:00<00:29, 634.03it/s]  1%|          | 135/18864 [00:00<00:28, 654.19it/s]  1%|          | 201/18864 [00:00<00:30, 606.40it/s]  1%|▏         | 262/18864 [00:00<00:32, 571.30it/s]  2%|▏         | 334/18864 [00:00<00:31, 597.22it/s]  2%|▏         | 399/18864 [00:00<00:30, 602.03it/s]  2%|▏         | 460/18864 [00:00<00:32, 567.53it/s]  3%|▎         | 539/18864 [00:00<00:28, 632.07it/s]  3%|▎         | 604/18864 [00:00<00:29, 621.24it/s]  4%|▎         | 667/18864 [00:01<00:29, 618.00it/s]  4%|▍         | 747/18864 [00:01<00:27, 668.41it/s]  4%|▍         | 815/18864 [00:01<00:31, 580.97it/s]  5%|▍         | 877/18864 [00:01<00:30, 590.06it/s]  5%|▍         | 938/18864 [00:01<00:32, 551.24it/s]  5%|▌         | 998/18864 [00:01<00:31, 562.10it/s]  6%|▌         | 1086/18864 [00:01<00:27, 649.18it/s]  6%|▌         | 1154/18864 [00:01<00:27, 654.19it/s]  6%|▋         | 1225/18864 [00:01<00:26, 669.26it/s]  7%|▋         | 1299/18864 [00:02<00:25, 687.57it/s]  7%|▋         | 1369/18864 [00:02<00:25, 684.74it/s]  8%|▊         | 1438/18864 [00:02<00:25, 679.04it/s]  8%|▊         | 1507/18864 [00:02<00:25, 677.49it/s]  8%|▊         | 1575/18864 [00:02<00:25, 677.73it/s]  9%|▉         | 1655/18864 [00:02<00:24, 711.56it/s]  9%|▉         | 1727/18864 [00:02<00:24, 709.91it/s] 10%|▉         | 1823/18864 [00:02<00:21, 782.43it/s] 10%|█         | 1902/18864 [00:02<00:22, 761.20it/s] 11%|█         | 1984/18864 [00:03<00:21, 777.39it/s] 11%|█         | 2062/18864 [00:03<00:21, 777.06it/s] 11%|█▏        | 2140/18864 [00:03<00:21, 769.25it/s] 12%|█▏        | 2219/18864 [00:03<00:21, 768.82it/s] 12%|█▏        | 2296/18864 [00:03<00:23, 716.50it/s] 13%|█▎        | 2374/18864 [00:03<00:22, 734.25it/s] 13%|█▎        | 2449/18864 [00:03<00:22, 725.72it/s] 13%|█▎        | 2522/18864 [00:03<00:23, 686.19it/s] 14%|█▎        | 2592/18864 [00:03<00:25, 632.58it/s] 14%|█▍        | 2657/18864 [00:04<00:28, 562.64it/s] 15%|█▍        | 2737/18864 [00:04<00:25, 622.26it/s] 15%|█▍        | 2819/18864 [00:04<00:23, 673.57it/s] 15%|█▌        | 2889/18864 [00:04<00:25, 634.51it/s] 16%|█▌        | 2965/18864 [00:04<00:23, 666.37it/s] 16%|█▌        | 3038/18864 [00:04<00:23, 676.75it/s] 16%|█▋        | 3107/18864 [00:04<00:23, 671.01it/s] 17%|█▋        | 3175/18864 [00:04<00:23, 657.41it/s] 17%|█▋        | 3243/18864 [00:04<00:23, 662.47it/s] 18%|█▊        | 3329/18864 [00:05<00:22, 685.89it/s] 18%|█▊        | 3398/18864 [00:05<00:23, 669.78it/s] 18%|█▊        | 3481/18864 [00:05<00:21, 705.91it/s] 19%|█▉        | 3552/18864 [00:05<00:22, 695.19it/s] 19%|█▉        | 3622/18864 [00:05<00:25, 603.90it/s] 20%|█▉        | 3690/18864 [00:05<00:24, 617.94it/s] 20%|█▉        | 3765/18864 [00:05<00:23, 653.32it/s] 20%|██        | 3832/18864 [00:05<00:22, 655.39it/s] 21%|██        | 3921/18864 [00:05<00:20, 718.72it/s] 21%|██▏       | 4009/18864 [00:05<00:19, 760.28it/s] 22%|██▏       | 4086/18864 [00:06<00:19, 751.24it/s] 22%|██▏       | 4162/18864 [00:06<00:20, 721.79it/s] 22%|██▏       | 4235/18864 [00:06<00:20, 706.47it/s] 23%|██▎       | 4307/18864 [00:06<00:20, 694.98it/s] 23%|██▎       | 4377/18864 [00:06<00:24, 580.26it/s] 24%|██▎       | 4475/18864 [00:06<00:21, 680.60it/s] 24%|██▍       | 4570/18864 [00:06<00:19, 750.21it/s] 25%|██▍       | 4649/18864 [00:06<00:21, 665.59it/s] 25%|██▌       | 4720/18864 [00:07<00:21, 666.74it/s] 25%|██▌       | 4790/18864 [00:07<00:21, 662.55it/s] 26%|██▌       | 4872/18864 [00:07<00:19, 704.01it/s] 26%|██▌       | 4945/18864 [00:07<00:19, 710.36it/s] 27%|██▋       | 5043/18864 [00:07<00:17, 785.65it/s] 27%|██▋       | 5123/18864 [00:07<00:17, 763.56it/s] 28%|██▊       | 5201/18864 [00:07<00:20, 673.19it/s] 28%|██▊       | 5286/18864 [00:07<00:18, 717.15it/s] 28%|██▊       | 5361/18864 [00:07<00:19, 699.47it/s] 29%|██▉       | 5433/18864 [00:08<00:19, 681.84it/s] 29%|██▉       | 5505/18864 [00:08<00:19, 691.69it/s] 30%|██▉       | 5586/18864 [00:08<00:18, 721.25it/s] 30%|███       | 5667/18864 [00:08<00:18, 720.48it/s] 30%|███       | 5740/18864 [00:08<00:18, 711.48it/s] 31%|███       | 5822/18864 [00:08<00:17, 741.54it/s] 31%|███▏      | 5897/18864 [00:08<00:18, 708.81it/s] 32%|███▏      | 5969/18864 [00:08<00:19, 670.82it/s] 32%|███▏      | 6043/18864 [00:08<00:18, 685.05it/s] 32%|███▏      | 6123/18864 [00:09<00:18, 707.38it/s] 33%|███▎      | 6195/18864 [00:09<00:17, 706.39it/s] 33%|███▎      | 6269/18864 [00:09<00:17, 715.96it/s] 34%|███▎      | 6345/18864 [00:09<00:17, 724.54it/s] 34%|███▍      | 6431/18864 [00:09<00:16, 759.58it/s] 35%|███▍      | 6514/18864 [00:09<00:15, 777.62it/s] 35%|███▍      | 6593/18864 [00:09<00:15, 774.43it/s] 35%|███▌      | 6672/18864 [00:09<00:16, 725.57it/s] 36%|███▌      | 6752/18864 [00:09<00:16, 735.75it/s] 36%|███▌      | 6827/18864 [00:09<00:16, 726.13it/s] 37%|███▋      | 6900/18864 [00:10<00:18, 641.99it/s] 37%|███▋      | 6980/18864 [00:10<00:17, 682.22it/s] 37%|███▋      | 7057/18864 [00:10<00:16, 703.44it/s] 38%|███▊      | 7135/18864 [00:10<00:16, 723.13it/s] 38%|███▊      | 7209/18864 [00:10<00:19, 610.19it/s] 39%|███▊      | 7291/18864 [00:10<00:17, 662.61it/s] 39%|███▉      | 7365/18864 [00:10<00:16, 677.78it/s] 39%|███▉      | 7436/18864 [00:10<00:16, 677.79it/s] 40%|███▉      | 7509/18864 [00:11<00:16, 689.60it/s] 40%|████      | 7586/18864 [00:11<00:15, 709.59it/s] 41%|████      | 7671/18864 [00:11<00:14, 749.02it/s] 41%|████      | 7747/18864 [00:11<00:15, 697.29it/s] 42%|████▏     | 7839/18864 [00:11<00:14, 758.03it/s] 42%|████▏     | 7917/18864 [00:11<00:16, 651.69it/s] 42%|████▏     | 8002/18864 [00:11<00:15, 701.42it/s] 43%|████▎     | 8076/18864 [00:11<00:15, 675.77it/s] 43%|████▎     | 8153/18864 [00:11<00:15, 673.08it/s] 44%|████▎     | 8252/18864 [00:12<00:14, 753.51it/s] 44%|████▍     | 8330/18864 [00:12<00:14, 741.45it/s] 45%|████▍     | 8427/18864 [00:12<00:12, 803.82it/s] 45%|████▌     | 8512/18864 [00:12<00:12, 798.86it/s] 46%|████▌     | 8593/18864 [00:12<00:12, 798.45it/s] 46%|████▌     | 8674/18864 [00:12<00:13, 781.98it/s] 46%|████▋     | 8753/18864 [00:12<00:13, 769.91it/s] 47%|████▋     | 8841/18864 [00:12<00:12, 800.73it/s] 47%|████▋     | 8922/18864 [00:12<00:12, 777.31it/s] 48%|████▊     | 9001/18864 [00:13<00:13, 731.22it/s] 48%|████▊     | 9078/18864 [00:13<00:13, 741.81it/s] 49%|████▊     | 9155/18864 [00:13<00:12, 748.49it/s] 49%|████▉     | 9231/18864 [00:13<00:14, 664.73it/s] 49%|████▉     | 9313/18864 [00:13<00:13, 703.96it/s] 50%|████▉     | 9393/18864 [00:13<00:12, 729.44it/s] 50%|█████     | 9468/18864 [00:13<00:13, 702.32it/s] 51%|█████     | 9553/18864 [00:13<00:12, 738.40it/s] 51%|█████     | 9628/18864 [00:13<00:12, 728.35it/s] 52%|█████▏    | 9732/18864 [00:14<00:20, 441.70it/s] 52%|█████▏    | 9826/18864 [00:14<00:17, 531.26it/s] 53%|█████▎    | 9920/18864 [00:14<00:14, 611.25it/s] 53%|█████▎    | 9997/18864 [00:14<00:13, 634.94it/s] 53%|█████▎    | 10072/18864 [00:14<00:14, 610.34it/s] 54%|█████▍    | 10141/18864 [00:14<00:13, 628.93it/s] 54%|█████▍    | 10237/18864 [00:14<00:12, 710.90it/s] 55%|█████▍    | 10314/18864 [00:15<00:12, 702.94it/s] 55%|█████▌    | 10389/18864 [00:15<00:13, 650.32it/s] 56%|█████▌    | 10477/18864 [00:15<00:11, 709.65it/s] 56%|█████▌    | 10552/18864 [00:15<00:11, 707.26it/s] 56%|█████▋    | 10629/18864 [00:15<00:11, 721.91it/s] 57%|█████▋    | 10706/18864 [00:15<00:11, 732.24it/s] 57%|█████▋    | 10803/18864 [00:15<00:10, 788.99it/s] 58%|█████▊    | 10883/18864 [00:15<00:12, 630.59it/s] 58%|█████▊    | 10952/18864 [00:15<00:12, 640.98it/s] 59%|█████▊    | 11038/18864 [00:16<00:11, 697.08it/s] 59%|█████▉    | 11114/18864 [00:16<00:10, 710.63it/s] 59%|█████▉    | 11200/18864 [00:16<00:10, 749.75it/s] 60%|█████▉    | 11285/18864 [00:16<00:09, 774.25it/s] 60%|██████    | 11365/18864 [00:16<00:09, 770.01it/s] 61%|██████    | 11463/18864 [00:16<00:08, 830.03it/s] 61%|██████    | 11548/18864 [00:16<00:13, 537.77it/s] 62%|██████▏   | 11631/18864 [00:16<00:12, 599.29it/s] 62%|██████▏   | 11704/18864 [00:17<00:11, 627.91it/s] 62%|██████▏   | 11777/18864 [00:17<00:11, 643.88it/s] 63%|██████▎   | 11862/18864 [00:17<00:10, 688.02it/s] 63%|██████▎   | 11937/18864 [00:17<00:10, 651.18it/s] 64%|██████▍   | 12030/18864 [00:17<00:09, 722.75it/s] 64%|██████▍   | 12107/18864 [00:17<00:09, 712.88it/s] 65%|██████▍   | 12192/18864 [00:17<00:08, 749.92it/s] 65%|██████▌   | 12270/18864 [00:17<00:08, 756.72it/s] 65%|██████▌   | 12348/18864 [00:17<00:08, 747.93it/s] 66%|██████▌   | 12431/18864 [00:18<00:08, 743.53it/s] 66%|██████▋   | 12507/18864 [00:18<00:08, 739.48it/s] 67%|██████▋   | 12592/18864 [00:18<00:08, 770.57it/s] 67%|██████▋   | 12679/18864 [00:18<00:07, 799.23it/s] 68%|██████▊   | 12760/18864 [00:18<00:08, 745.52it/s] 68%|██████▊   | 12850/18864 [00:18<00:07, 778.45it/s] 69%|██████▊   | 12929/18864 [00:18<00:07, 775.03it/s] 69%|██████▉   | 13017/18864 [00:18<00:07, 804.65it/s] 69%|██████▉   | 13099/18864 [00:18<00:07, 797.42it/s] 70%|██████▉   | 13189/18864 [00:19<00:06, 818.93it/s] 70%|███████   | 13272/18864 [00:19<00:06, 802.65it/s] 71%|███████   | 13353/18864 [00:19<00:07, 782.60it/s] 71%|███████   | 13435/18864 [00:19<00:06, 792.07it/s] 72%|███████▏  | 13515/18864 [00:19<00:06, 767.73it/s] 72%|███████▏  | 13599/18864 [00:19<00:07, 746.42it/s] 73%|███████▎  | 13688/18864 [00:19<00:06, 774.57it/s] 73%|███████▎  | 13766/18864 [00:19<00:06, 765.40it/s] 73%|███████▎  | 13860/18864 [00:19<00:06, 801.60it/s] 74%|███████▍  | 13941/18864 [00:19<00:06, 761.98it/s] 74%|███████▍  | 14025/18864 [00:20<00:06, 782.94it/s] 75%|███████▍  | 14108/18864 [00:20<00:05, 794.25it/s] 75%|███████▌  | 14188/18864 [00:20<00:05, 789.93it/s] 76%|███████▌  | 14268/18864 [00:20<00:05, 775.98it/s] 76%|███████▌  | 14348/18864 [00:20<00:05, 782.76it/s] 77%|███████▋  | 14434/18864 [00:20<00:05, 804.99it/s] 77%|███████▋  | 14528/18864 [00:20<00:05, 792.45it/s] 77%|███████▋  | 14608/18864 [00:20<00:05, 773.09it/s] 78%|███████▊  | 14686/18864 [00:20<00:05, 733.51it/s] 78%|███████▊  | 14769/18864 [00:21<00:05, 756.86it/s] 79%|███████▉  | 14877/18864 [00:21<00:04, 845.68it/s] 79%|███████▉  | 14963/18864 [00:21<00:04, 835.31it/s] 80%|███████▉  | 15048/18864 [00:21<00:04, 830.60it/s] 80%|████████  | 15132/18864 [00:21<00:04, 820.04it/s] 81%|████████  | 15234/18864 [00:21<00:04, 876.92it/s] 81%|████████  | 15323/18864 [00:21<00:04, 851.99it/s] 82%|████████▏ | 15409/18864 [00:21<00:04, 842.60it/s] 82%|████████▏ | 15494/18864 [00:21<00:04, 778.62it/s] 83%|████████▎ | 15573/18864 [00:22<00:04, 774.97it/s] 83%|████████▎ | 15674/18864 [00:22<00:03, 837.09it/s] 84%|████████▎ | 15761/18864 [00:22<00:03, 843.36it/s] 84%|████████▍ | 15880/18864 [00:22<00:03, 935.59it/s] 85%|████████▍ | 15975/18864 [00:22<00:03, 865.67it/s] 85%|████████▌ | 16063/18864 [00:22<00:03, 855.22it/s] 86%|████████▌ | 16150/18864 [00:22<00:03, 799.94it/s] 86%|████████▌ | 16232/18864 [00:22<00:03, 664.60it/s] 86%|████████▋ | 16311/18864 [00:22<00:03, 694.80it/s] 87%|████████▋ | 16399/18864 [00:23<00:03, 736.38it/s] 87%|████████▋ | 16496/18864 [00:23<00:02, 797.81it/s] 88%|████████▊ | 16594/18864 [00:23<00:02, 845.55it/s] 88%|████████▊ | 16681/18864 [00:23<00:02, 836.38it/s] 89%|████████▉ | 16773/18864 [00:23<00:02, 834.26it/s] 89%|████████▉ | 16869/18864 [00:23<00:02, 867.48it/s] 90%|████████▉ | 16957/18864 [00:23<00:02, 833.50it/s] 90%|█████████ | 17060/18864 [00:23<00:02, 885.02it/s] 91%|█████████ | 17150/18864 [00:23<00:02, 846.40it/s] 91%|█████████▏| 17255/18864 [00:24<00:01, 900.69it/s] 92%|█████████▏| 17347/18864 [00:24<00:01, 905.30it/s] 92%|█████████▏| 17439/18864 [00:24<00:01, 876.75it/s] 93%|█████████▎| 17528/18864 [00:24<00:01, 830.51it/s] 93%|█████████▎| 17612/18864 [00:24<00:01, 759.72it/s] 94%|█████████▍| 17690/18864 [00:24<00:01, 750.48it/s] 94%|█████████▍| 17766/18864 [00:24<00:01, 727.26it/s] 95%|█████████▍| 17850/18864 [00:24<00:01, 757.66it/s] 95%|█████████▌| 17937/18864 [00:24<00:01, 781.92it/s] 96%|█████████▌| 18016/18864 [00:25<00:01, 755.40it/s] 96%|█████████▌| 18099/18864 [00:25<00:01, 742.63it/s] 96%|█████████▋| 18174/18864 [00:25<00:00, 738.41it/s] 97%|█████████▋| 18249/18864 [00:25<00:00, 708.73it/s] 97%|█████████▋| 18349/18864 [00:25<00:00, 787.90it/s] 98%|█████████▊| 18434/18864 [00:25<00:00, 805.08it/s] 98%|█████████▊| 18516/18864 [00:25<00:00, 711.79it/s] 99%|█████████▊| 18592/18864 [00:25<00:00, 722.92it/s] 99%|█████████▉| 18667/18864 [00:25<00:00, 704.49it/s] 99%|█████████▉| 18756/18864 [00:26<00:00, 754.93it/s]100%|█████████▉| 18833/18864 [00:26<00:00, 697.49it/s]100%|██████████| 18864/18864 [00:26<00:00, 719.91it/s]
11/22/2023 11:21:18 - INFO - __main__ -   ***** Running Test *****
11/22/2023 11:21:18 - INFO - __main__ -     Num examples = 18864
11/22/2023 11:21:18 - INFO - __main__ -     Batch size = 256
11/22/2023 11:26:44 - INFO - __main__ -   ***** Test results *****
11/22/2023 11:26:44 - INFO - __main__ -     test_accuracy = 0.9351
11/22/2023 11:26:44 - INFO - __main__ -     test_f1 = 0.0208
11/22/2023 11:26:44 - INFO - __main__ -     test_precision = 0.0667
11/22/2023 11:26:44 - INFO - __main__ -     test_recall = 0.0123
11/22/2023 11:26:44 - INFO - __main__ -     test_threshold = 0.5
