slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/home/schroeder_e/slurm-scripts/linevul': No such file or directory: going to /tmp instead
Matplotlib created a temporary cache directory at /scratch/39443/matplotlib-g0igbks_ because the default path (/home/schroeder_e/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
11/22/2023 10:46:42 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.out_proj.weight', 'classifier.dense.weight', 'classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
11/22/2023 10:46:47 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/big-vul_dataset/val.csv', test_data_file='../data/big-vul_dataset/test.csv', model_name='bpebert.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=256, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
  0%|          | 0/18864 [00:00<?, ?it/s]  0%|          | 67/18864 [00:00<00:29, 639.29it/s]  1%|          | 135/18864 [00:00<00:28, 657.96it/s]  1%|          | 201/18864 [00:00<00:30, 608.15it/s]  1%|▏         | 263/18864 [00:00<00:31, 584.70it/s]  2%|▏         | 334/18864 [00:00<00:30, 607.26it/s]  2%|▏         | 399/18864 [00:00<00:30, 610.64it/s]  2%|▏         | 461/18864 [00:00<00:31, 578.23it/s]  3%|▎         | 540/18864 [00:00<00:28, 640.21it/s]  3%|▎         | 605/18864 [00:00<00:29, 626.10it/s]  4%|▎         | 669/18864 [00:01<00:29, 619.38it/s]  4%|▍         | 749/18864 [00:01<00:27, 667.16it/s]  4%|▍         | 817/18864 [00:01<00:30, 588.40it/s]  5%|▍         | 878/18864 [00:01<00:30, 589.60it/s]  5%|▍         | 939/18864 [00:01<00:32, 556.38it/s]  5%|▌         | 998/18864 [00:01<00:31, 565.23it/s]  6%|▌         | 1087/18864 [00:01<00:27, 648.26it/s]  6%|▌         | 1157/18864 [00:01<00:26, 662.01it/s]  7%|▋         | 1230/18864 [00:01<00:25, 679.72it/s]  7%|▋         | 1307/18864 [00:02<00:24, 703.33it/s]  7%|▋         | 1378/18864 [00:02<00:25, 691.56it/s]  8%|▊         | 1448/18864 [00:02<00:25, 686.62it/s]  8%|▊         | 1517/18864 [00:02<00:25, 682.62it/s]  8%|▊         | 1586/18864 [00:02<00:25, 667.99it/s]  9%|▉         | 1670/18864 [00:02<00:23, 716.67it/s]  9%|▉         | 1742/18864 [00:02<00:24, 708.20it/s] 10%|▉         | 1830/18864 [00:02<00:22, 754.73it/s] 10%|█         | 1907/18864 [00:02<00:22, 756.98it/s] 11%|█         | 1993/18864 [00:03<00:21, 782.95it/s] 11%|█         | 2072/18864 [00:03<00:22, 760.29it/s] 11%|█▏        | 2164/18864 [00:03<00:20, 803.98it/s] 12%|█▏        | 2245/18864 [00:03<00:21, 776.43it/s] 12%|█▏        | 2323/18864 [00:03<00:22, 729.97it/s] 13%|█▎        | 2397/18864 [00:03<00:22, 724.54it/s] 13%|█▎        | 2470/18864 [00:03<00:23, 707.42it/s] 13%|█▎        | 2542/18864 [00:03<00:25, 633.31it/s] 14%|█▍        | 2607/18864 [00:03<00:27, 594.89it/s] 14%|█▍        | 2668/18864 [00:04<00:27, 588.47it/s] 15%|█▍        | 2754/18864 [00:04<00:24, 660.66it/s] 15%|█▌        | 2835/18864 [00:04<00:25, 638.37it/s] 15%|█▌        | 2909/18864 [00:04<00:24, 664.24it/s] 16%|█▌        | 2986/18864 [00:04<00:22, 693.08it/s] 16%|█▌        | 3059/18864 [00:04<00:22, 700.90it/s] 17%|█▋        | 3130/18864 [00:04<00:23, 675.67it/s] 17%|█▋        | 3199/18864 [00:04<00:24, 643.68it/s] 17%|█▋        | 3274/18864 [00:04<00:23, 672.78it/s] 18%|█▊        | 3350/18864 [00:05<00:22, 695.64it/s] 18%|█▊        | 3421/18864 [00:05<00:22, 686.19it/s] 19%|█▊        | 3501/18864 [00:05<00:21, 710.58it/s] 19%|█▉        | 3576/18864 [00:05<00:21, 720.59it/s] 19%|█▉        | 3649/18864 [00:05<00:24, 623.82it/s] 20%|█▉        | 3714/18864 [00:05<00:24, 627.78it/s] 20%|██        | 3783/18864 [00:05<00:23, 644.57it/s] 20%|██        | 3850/18864 [00:05<00:23, 650.03it/s] 21%|██        | 3940/18864 [00:05<00:20, 719.56it/s] 21%|██▏       | 4026/18864 [00:06<00:20, 726.25it/s] 22%|██▏       | 4107/18864 [00:06<00:19, 748.37it/s] 22%|██▏       | 4183/18864 [00:06<00:19, 737.11it/s] 23%|██▎       | 4258/18864 [00:06<00:21, 691.98it/s] 23%|██▎       | 4328/18864 [00:06<00:21, 690.23it/s] 23%|██▎       | 4398/18864 [00:06<00:24, 585.43it/s] 24%|██▍       | 4506/18864 [00:06<00:20, 709.42it/s] 24%|██▍       | 4594/18864 [00:06<00:19, 743.11it/s] 25%|██▍       | 4672/18864 [00:06<00:22, 634.19it/s] 25%|██▌       | 4752/18864 [00:07<00:20, 674.71it/s] 26%|██▌       | 4824/18864 [00:07<00:20, 673.56it/s] 26%|██▌       | 4895/18864 [00:07<00:20, 678.74it/s] 26%|██▋       | 4976/18864 [00:07<00:19, 711.42it/s] 27%|██▋       | 5080/18864 [00:07<00:17, 800.36it/s] 27%|██▋       | 5162/18864 [00:07<00:20, 670.28it/s] 28%|██▊       | 5250/18864 [00:07<00:18, 723.09it/s] 28%|██▊       | 5327/18864 [00:07<00:19, 696.43it/s] 29%|██▊       | 5400/18864 [00:07<00:19, 704.73it/s] 29%|██▉       | 5473/18864 [00:08<00:19, 679.63it/s] 29%|██▉       | 5545/18864 [00:08<00:19, 681.57it/s] 30%|██▉       | 5633/18864 [00:08<00:18, 734.19it/s] 30%|███       | 5708/18864 [00:08<00:19, 685.84it/s] 31%|███       | 5801/18864 [00:08<00:17, 750.37it/s] 31%|███       | 5878/18864 [00:08<00:17, 725.09it/s] 32%|███▏      | 5952/18864 [00:08<00:19, 649.71it/s] 32%|███▏      | 6033/18864 [00:08<00:18, 691.15it/s] 32%|███▏      | 6105/18864 [00:08<00:18, 697.19it/s] 33%|███▎      | 6177/18864 [00:09<00:18, 671.12it/s] 33%|███▎      | 6262/18864 [00:09<00:17, 720.23it/s] 34%|███▎      | 6336/18864 [00:09<00:17, 719.35it/s] 34%|███▍      | 6416/18864 [00:09<00:16, 737.55it/s] 34%|███▍      | 6496/18864 [00:09<00:16, 755.37it/s] 35%|███▍      | 6576/18864 [00:09<00:16, 766.54it/s] 35%|███▌      | 6661/18864 [00:09<00:15, 778.37it/s] 36%|███▌      | 6740/18864 [00:09<00:16, 721.10it/s] 36%|███▌      | 6814/18864 [00:09<00:17, 677.97it/s] 36%|███▋      | 6883/18864 [00:10<00:19, 619.83it/s] 37%|███▋      | 6967/18864 [00:10<00:17, 676.18it/s] 37%|███▋      | 7037/18864 [00:10<00:17, 678.95it/s] 38%|███▊      | 7111/18864 [00:10<00:16, 695.36it/s] 38%|███▊      | 7182/18864 [00:10<00:17, 679.22it/s] 38%|███▊      | 7251/18864 [00:10<00:19, 603.04it/s] 39%|███▉      | 7323/18864 [00:10<00:18, 630.27it/s] 39%|███▉      | 7395/18864 [00:10<00:17, 651.97it/s] 40%|███▉      | 7481/18864 [00:11<00:17, 663.41it/s] 40%|████      | 7559/18864 [00:11<00:16, 689.96it/s] 41%|████      | 7647/18864 [00:11<00:15, 742.73it/s] 41%|████      | 7723/18864 [00:11<00:16, 676.48it/s] 41%|████▏     | 7815/18864 [00:11<00:14, 741.41it/s] 42%|████▏     | 7892/18864 [00:11<00:15, 691.67it/s] 42%|████▏     | 7964/18864 [00:11<00:16, 674.38it/s] 43%|████▎     | 8033/18864 [00:11<00:16, 663.56it/s] 43%|████▎     | 8107/18864 [00:11<00:15, 681.41it/s] 43%|████▎     | 8178/18864 [00:11<00:15, 688.91it/s] 44%|████▍     | 8269/18864 [00:12<00:14, 751.81it/s] 44%|████▍     | 8345/18864 [00:12<00:14, 738.64it/s] 45%|████▍     | 8449/18864 [00:12<00:12, 824.74it/s] 45%|████▌     | 8533/18864 [00:12<00:13, 793.05it/s] 46%|████▌     | 8617/18864 [00:12<00:12, 804.57it/s] 46%|████▌     | 8698/18864 [00:12<00:13, 772.73it/s] 47%|████▋     | 8776/18864 [00:12<00:13, 762.86it/s] 47%|████▋     | 8861/18864 [00:12<00:12, 785.85it/s] 47%|████▋     | 8940/18864 [00:12<00:13, 739.66it/s] 48%|████▊     | 9015/18864 [00:13<00:13, 737.64it/s] 48%|████▊     | 9090/18864 [00:13<00:13, 733.95it/s] 49%|████▊     | 9165/18864 [00:13<00:13, 737.49it/s] 49%|████▉     | 9239/18864 [00:13<00:14, 657.31it/s] 49%|████▉     | 9314/18864 [00:13<00:14, 681.24it/s] 50%|████▉     | 9401/18864 [00:13<00:12, 733.39it/s] 50%|█████     | 9476/18864 [00:13<00:13, 692.60it/s] 51%|█████     | 9558/18864 [00:13<00:13, 697.66it/s] 51%|█████     | 9642/18864 [00:13<00:12, 732.20it/s] 52%|█████▏    | 9731/18864 [00:14<00:20, 451.99it/s] 52%|█████▏    | 9825/18864 [00:14<00:16, 544.10it/s] 53%|█████▎    | 9920/18864 [00:14<00:14, 623.94it/s] 53%|█████▎    | 9997/18864 [00:14<00:13, 644.28it/s] 53%|█████▎    | 10072/18864 [00:14<00:14, 613.76it/s] 54%|█████▍    | 10141/18864 [00:14<00:13, 630.72it/s] 54%|█████▍    | 10237/18864 [00:14<00:12, 710.96it/s] 55%|█████▍    | 10314/18864 [00:15<00:12, 701.03it/s] 55%|█████▌    | 10388/18864 [00:15<00:13, 649.60it/s] 56%|█████▌    | 10475/18864 [00:15<00:11, 705.81it/s] 56%|█████▌    | 10549/18864 [00:15<00:11, 704.21it/s] 56%|█████▋    | 10624/18864 [00:15<00:11, 715.88it/s] 57%|█████▋    | 10699/18864 [00:15<00:11, 723.35it/s] 57%|█████▋    | 10794/18864 [00:15<00:10, 787.07it/s] 58%|█████▊    | 10874/18864 [00:15<00:12, 643.36it/s] 58%|█████▊    | 10944/18864 [00:16<00:12, 630.55it/s] 58%|█████▊    | 11031/18864 [00:16<00:11, 690.97it/s] 59%|█████▉    | 11110/18864 [00:16<00:11, 702.73it/s] 59%|█████▉    | 11196/18864 [00:16<00:10, 745.51it/s] 60%|█████▉    | 11282/18864 [00:16<00:09, 774.98it/s] 60%|██████    | 11362/18864 [00:16<00:09, 760.82it/s] 61%|██████    | 11458/18864 [00:16<00:09, 816.14it/s] 61%|██████    | 11541/18864 [00:16<00:13, 538.86it/s] 62%|██████▏   | 11616/18864 [00:17<00:12, 582.76it/s] 62%|██████▏   | 11687/18864 [00:17<00:11, 611.54it/s] 62%|██████▏   | 11770/18864 [00:17<00:10, 648.01it/s] 63%|██████▎   | 11852/18864 [00:17<00:10, 688.62it/s] 63%|██████▎   | 11928/18864 [00:17<00:09, 706.68it/s] 64%|██████▎   | 12003/18864 [00:17<00:10, 685.43it/s] 64%|██████▍   | 12078/18864 [00:17<00:09, 702.73it/s] 64%|██████▍   | 12160/18864 [00:17<00:09, 732.65it/s] 65%|██████▍   | 12241/18864 [00:17<00:08, 753.61it/s] 65%|██████▌   | 12318/18864 [00:17<00:08, 747.56it/s] 66%|██████▌   | 12396/18864 [00:18<00:08, 756.07it/s] 66%|██████▌   | 12473/18864 [00:18<00:08, 739.30it/s] 67%|██████▋   | 12548/18864 [00:18<00:08, 733.73it/s] 67%|██████▋   | 12626/18864 [00:18<00:08, 744.91it/s] 67%|██████▋   | 12716/18864 [00:18<00:08, 767.18it/s] 68%|██████▊   | 12794/18864 [00:18<00:07, 770.10it/s] 68%|██████▊   | 12872/18864 [00:18<00:07, 765.34it/s] 69%|██████▊   | 12951/18864 [00:18<00:07, 769.80it/s] 69%|██████▉   | 13029/18864 [00:18<00:07, 753.36it/s] 70%|██████▉   | 13128/18864 [00:19<00:06, 821.22it/s] 70%|███████   | 13211/18864 [00:19<00:07, 781.06it/s] 70%|███████   | 13296/18864 [00:19<00:06, 800.62it/s] 71%|███████   | 13377/18864 [00:19<00:07, 778.25it/s] 71%|███████▏  | 13460/18864 [00:19<00:06, 788.36it/s] 72%|███████▏  | 13540/18864 [00:19<00:07, 753.13it/s] 72%|███████▏  | 13619/18864 [00:19<00:06, 762.88it/s] 73%|███████▎  | 13696/18864 [00:19<00:06, 760.44it/s] 73%|███████▎  | 13773/18864 [00:19<00:06, 739.92it/s] 73%|███████▎  | 13860/18864 [00:19<00:06, 770.65it/s] 74%|███████▍  | 13938/18864 [00:20<00:06, 703.85it/s] 74%|███████▍  | 14025/18864 [00:20<00:06, 748.16it/s] 75%|███████▍  | 14108/18864 [00:20<00:06, 767.98it/s] 75%|███████▌  | 14188/18864 [00:20<00:06, 769.38it/s] 76%|███████▌  | 14266/18864 [00:20<00:06, 757.40it/s] 76%|███████▌  | 14344/18864 [00:20<00:05, 761.74it/s] 76%|███████▋  | 14430/18864 [00:20<00:05, 789.94it/s] 77%|███████▋  | 14521/18864 [00:20<00:05, 824.41it/s] 77%|███████▋  | 14604/18864 [00:20<00:05, 756.50it/s] 78%|███████▊  | 14681/18864 [00:21<00:05, 722.46it/s] 78%|███████▊  | 14766/18864 [00:21<00:05, 754.39it/s] 79%|███████▉  | 14874/18864 [00:21<00:04, 844.27it/s] 79%|███████▉  | 14960/18864 [00:21<00:04, 834.49it/s] 80%|███████▉  | 15045/18864 [00:21<00:04, 833.24it/s] 80%|████████  | 15129/18864 [00:21<00:04, 825.07it/s] 81%|████████  | 15228/18864 [00:21<00:04, 871.28it/s] 81%|████████  | 15316/18864 [00:21<00:04, 861.40it/s] 82%|████████▏ | 15403/18864 [00:21<00:04, 827.64it/s] 82%|████████▏ | 15487/18864 [00:22<00:04, 768.24it/s] 83%|████████▎ | 15565/18864 [00:22<00:04, 766.02it/s] 83%|████████▎ | 15667/18864 [00:22<00:03, 836.13it/s] 84%|████████▎ | 15752/18864 [00:22<00:03, 836.24it/s] 84%|████████▍ | 15875/18864 [00:22<00:03, 942.34it/s] 85%|████████▍ | 15970/18864 [00:22<00:03, 861.48it/s] 85%|████████▌ | 16058/18864 [00:22<00:03, 850.80it/s] 86%|████████▌ | 16145/18864 [00:22<00:03, 797.05it/s] 86%|████████▌ | 16226/18864 [00:22<00:04, 658.82it/s] 86%|████████▋ | 16307/18864 [00:23<00:03, 690.19it/s] 87%|████████▋ | 16396/18864 [00:23<00:03, 740.01it/s] 87%|████████▋ | 16491/18864 [00:23<00:02, 794.84it/s] 88%|████████▊ | 16586/18864 [00:23<00:02, 836.53it/s] 88%|████████▊ | 16673/18864 [00:23<00:02, 818.53it/s] 89%|████████▉ | 16771/18864 [00:23<00:02, 859.55it/s] 89%|████████▉ | 16861/18864 [00:23<00:02, 870.48it/s] 90%|████████▉ | 16950/18864 [00:23<00:02, 814.12it/s] 90%|█████████ | 17052/18864 [00:23<00:02, 869.49it/s] 91%|█████████ | 17141/18864 [00:24<00:02, 860.09it/s] 91%|█████████▏| 17230/18864 [00:24<00:01, 864.69it/s] 92%|█████████▏| 17328/18864 [00:24<00:01, 896.33it/s] 92%|█████████▏| 17419/18864 [00:24<00:01, 876.83it/s] 93%|█████████▎| 17508/18864 [00:24<00:01, 838.48it/s] 93%|█████████▎| 17593/18864 [00:24<00:01, 789.25it/s] 94%|█████████▎| 17673/18864 [00:24<00:01, 742.65it/s] 94%|█████████▍| 17749/18864 [00:24<00:01, 721.52it/s] 95%|█████████▍| 17832/18864 [00:24<00:01, 738.96it/s] 95%|█████████▍| 17918/18864 [00:25<00:01, 769.35it/s] 95%|█████████▌| 17998/18864 [00:25<00:01, 758.42it/s] 96%|█████████▌| 18078/18864 [00:25<00:01, 768.12it/s] 96%|█████████▌| 18156/18864 [00:25<00:00, 752.64it/s] 97%|█████████▋| 18232/18864 [00:25<00:00, 672.83it/s] 97%|█████████▋| 18334/18864 [00:25<00:00, 765.08it/s] 98%|█████████▊| 18420/18864 [00:25<00:00, 790.38it/s] 98%|█████████▊| 18501/18864 [00:25<00:00, 734.67it/s] 98%|█████████▊| 18577/18864 [00:25<00:00, 700.01it/s] 99%|█████████▉| 18649/18864 [00:26<00:00, 672.10it/s] 99%|█████████▉| 18744/18864 [00:26<00:00, 736.13it/s]100%|█████████▉| 18819/18864 [00:26<00:00, 696.07it/s]100%|██████████| 18864/18864 [00:26<00:00, 715.89it/s]
11/22/2023 10:47:26 - INFO - __main__ -   ***** Running Test *****
11/22/2023 10:47:26 - INFO - __main__ -     Num examples = 18864
11/22/2023 10:47:26 - INFO - __main__ -     Batch size = 256
11/22/2023 10:52:53 - INFO - __main__ -   ***** Test results *****
11/22/2023 10:52:53 - INFO - __main__ -     test_accuracy = 0.8087
11/22/2023 10:52:53 - INFO - __main__ -     test_f1 = 0.0758
11/22/2023 10:52:53 - INFO - __main__ -     test_precision = 0.0519
11/22/2023 10:52:53 - INFO - __main__ -     test_recall = 0.1403
11/22/2023 10:52:53 - INFO - __main__ -     test_threshold = 0.5
